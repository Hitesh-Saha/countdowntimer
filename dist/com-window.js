/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/Compose_Window/com-window.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/Compose_Window/com-window.js":
/*!******************************************!*\
  !*** ./src/Compose_Window/com-window.js ***!
  \******************************************/
/*! no exports provided */
/*! all exports used */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _FACTORY_factory__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../FACTORY/factory */ \"./src/FACTORY/factory.js\");\n/* harmony import */ var _ContactFactory_contactFactory__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ContactFactory/contactFactory */ \"./src/ContactFactory/contactFactory.js\");\n\n\n\nconst [setAccessToken,getAccessToken,syncContact,getnextLink] = Object(_ContactFactory_contactFactory__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"])();\nconst [getSubject,getBody,getAttachment,getAddress,getMessage,getMasterKey,setSubject,setBody,setAttachment,setAddress,setMasterKey,removeAttachment,removeAddress] = Object(_FACTORY_factory__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])();\n\nvar subtype=\"\";\nlet selectedToEmail = []\nlet selectedCcEmail = []\nlet selectedBccEmail = []\nvar Emailid;\n// QUILL JS  \n\nOffice.onReady()\n.then(function () {\n  Office.context.ui.messageParent(\"Ready\", { targetOrigin: \"https://localhost:3000/dist/taskpane.js\" });\n  Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived, onMessageFromParent);\n\n});\n\nvar toolbarOptions = {\n  container: [\n   \n    ['bold', 'italic', 'underline', 'strike'],\n    ['blockquote', 'code-block'],\n    [{ 'list': 'ordered' }, { 'list': 'bullet' }],\n    [{ 'script': 'sub' }, { 'script': 'super' }],\n    [{ 'indent': '-1' }, { 'indent': '+1' }],\n    [{ 'direction': 'rtl' }],\n    [{ 'color': [] }, { 'background': [] }],\n   \n    ['clean'],\n    ['link'],\n    // ['emoji'], \n    // [{ 'font': [] }],\n    //  [{header: [1, 2, 3, false]}],\n  ],\n  handlers: {\n\n //   'emoji': function () {}\n  }\n}\ndocument.getElementById('constraint-handler').checked=true\nvar quill = new Quill('#quill-injection', {\n  modules: {\n    \"toolbar\": toolbarOptions,\n  },\n  // placeholder: 'Compose an epic...',\n  theme: 'snow',\n});\nvar isPassphrase;\ndocument.querySelector(\"#constraint-handler\").onclick=()=>{\nlet check=(document.getElementById('constraint-handler').checked)\nif(check){\nisPassphrase=true;\ndocument.querySelector(\".constraint__slider\").style.background=\"#0078D4\"\ndocument.querySelector(\".constraint__slider\").classList.remove(\"slider_red\")\ndocument.querySelector(\".constraint__slider\").classList.add(\"slider_blue\")\n}\nelse{\nisPassphrase=false\ndocument.querySelector(\".constraint__slider\").style.background=\"#04AA6D\"\ndocument.querySelector(\".constraint__slider\").classList.remove(\"slider_blue\")\ndocument.querySelector(\".constraint__slider\").classList.add(\"slider_red\")\n}\n// console.log(isPassphrase)\n}\n//console.log(document.getElementById('constraint-handler').checked)\nlet Subject=document.querySelector('.mail-subject-input')\nlet Body=document.querySelector('.ql-editor')\nlet discard_btn=document.querySelector('.mail-actions-discard-button');\nlet mailContainer = document.querySelector('.mail-container');\nlet mailToInput = document.getElementById('mail-to-input');\nlet mailCcInput = document.getElementById('mail-cc-input');\nlet mailBccInput = document.getElementById('mail-bcc-input');\nlet mailToInputDropdown = document.getElementById('mail-to-input-dropdown');\nlet mailCcInputDropdown = document.getElementById('mail-cc-input-dropdown');\nlet mailBccInputDropdown = document.getElementById('mail-bcc-input-dropdown');\nlet qlEditor = document.querySelector('.ql-editor');\nlet mailActionsContainer = document.querySelector('.mail-actions-container');\nlet quillInjection = document.getElementById('quill-injection');\n\nlet ccBtn = document.getElementById('mail-cc-btn');\nlet bccBtn = document.getElementById('mail-bcc-btn');\nlet mailCcContainer = document.getElementById('mail-cc-container');\nlet mailBccContainer = document.getElementById('mail-bcc-container');\n\nlet mailActionsSendButton = document.querySelector('.mail-actions-send-button');\nlet attach_btn=document.querySelector('.mail-actions-attachment-button');\nlet emoji_btn=document.querySelector('.mail-actions-emoji-button');\n\n// for contact-suggestion dropdown in the email input field \nmailToInput.onfocus = () => {\n  mailToInputDropdown.classList.remove('mail-users-input-dropdown-disabled');\n  mailCcInputDropdown.classList.add('mail-users-input-dropdown-disabled');\n  mailBccInputDropdown.classList.add('mail-users-input-dropdown-disabled');\n}\n\nmailCcInput.onfocus = () => {\n  mailToInputDropdown.classList.add('mail-users-input-dropdown-disabled');\n  mailCcInputDropdown.classList.remove('mail-users-input-dropdown-disabled');\n  mailBccInputDropdown.classList.add('mail-users-input-dropdown-disabled');\n}\n\nmailBccInput.onfocus = () => {\n  mailToInputDropdown.classList.add('mail-users-input-dropdown-disabled');\n  mailCcInputDropdown.classList.add('mail-users-input-dropdown-disabled');\n  mailBccInputDropdown.classList.remove('mail-users-input-dropdown-disabled');\n}\n\n\nmailContainer.onclick = (event) => {\n  if (event.target.id !== 'mail-to-input' && event.target.id !== 'mail-cc-input' && event.target.id !== 'mail-bcc-input') {\n    mailToInputDropdown.classList.add('mail-users-input-dropdown-disabled');\n    mailCcInputDropdown.classList.add('mail-users-input-dropdown-disabled');\n    mailBccInputDropdown.classList.add('mail-users-input-dropdown-disabled');\n  }\n}\n\n// for activating CC and BCC fields\nccBtn.onclick = () => {\n  mailCcContainer.classList.remove('mail-cc-disabled');\n  ccBtn.classList.add('mail-cc-bcc-btn-disabled');\n}\n\nbccBtn.onclick = () => {\n  mailBccContainer.classList.remove('mail-bcc-disabled');\n  bccBtn.classList.add('mail-cc-bcc-btn-disabled');\n}\n\nattach_btn.onchange=()=>{\n  //console.log('Attached')\n  fileAttachment()\n}\nconst config = { childList: true };\nlet observer = new MutationObserver(function(mutations) {\n  mutations.forEach(function(mutation) {\n      quillInjection.scrollBy(0, 22);\n  });\n});\nobserver.observe(qlEditor, config);\nmailActionsSendButton.onclick = () => {\n  send_btn();\n  observer.disconnect();\n}\nfunction getToData(){\n  //let ToData=\"suyash.srivastava14@outlook.com\"\n  let ToData = selectedToEmail\n\n  return ToData;\n}\n//-----------------UPDATE SUBJECT-----------------------\nSubject.onkeyup=()=>\n{\n  setSubject(Subject.value);\n}\n//-----------------UPDATE BODY--------------------------\nBody.onkeyup=()=>\n{\n  setBody(quill.root.innerHTML);\n}\n//-----------------SEND BUTTON-----------------------\nfunction send_btn(){\n  setBody(quill.root.innerHTML);\n  document.getElementById(\"overlay\").style.display = \"block\";\n  console.log(\"Inside Send button\")\n  let To_Data=getToData();\n  let sub=getSubject()\n  let body=getBody();\n  let type=\"data\"\n  let mail_json={}\n//console.log(subtype);\n  mail_json.to=\"\",mail_json.cc=\"\",mail_json.bcc=\"\"\n \n  //setAddress('TO',Emailid)\n  mail_json={\n    \"to\":getAddress().to,\n    \"from\":\"\",\n    \"cc\":getAddress().cc,\n    \"bcc\":getAddress().bcc,\n    \"subject\":sub,\n    \"body\":body,\n    \"attachments\":getAttachment(),\n    \"type\":type,\n    \"subtype\":subtype,\n    \"isPassphrase\":isPassphrase\n  }\n  Office.context.ui.messageParent(JSON.stringify(mail_json));\n}\n//--------------- DISCARD BUTTON------------------\ndiscard_btn.onclick=()=>{\n  //console.log(\"Closing Window\")\n  let data={\n    \"To\":\"\",\n    \"from\":{},\n    \"cc\":[],\n    \"bcc\":[],\n    \"subject\":\"\",\n    \"body\":\"\",\n    \"attachment\":\"\",\n    \"att_name\":\"\",\n    \"type\":\"CLOSE\"\n  }\n  Office.context.ui.messageParent(JSON.stringify(data));\n}\n\nlet inputFile=document.getElementById(\"actual-btn\")\nfunction fileAttachment(){\n  // const events = arguments[1];\n  // const readedFile = [...event.target.files]\nconst readedFile = [...inputFile.files]\n//console.log( readedFile)\n  readedFile.map(file=>{\n  readFileContent(file);\n  \n  })\n}\n// inputFile.addEventListener(\"change\",fileAttachment)\nvar attachmentArr=[];\nvar attachmentName=[];  \nconsole.log(\"NOT ABLE TO READ VIDEO FILE\")\nfunction readFileContent(file){               \nvar fileReader = new FileReader();\nfileReader.onload = function(fileLoadedEvent){\nvar textFromFileLoaded = /,(.+)/.exec(fileLoadedEvent.target.result)[1];\n    // attachmentArr.push(textFromFileLoaded)      \n    // attachmentName.push(file.name); \n    let id=Math.floor(Math.random()*1000)\n    setAttachment(id,\"MIME\",file.name,textFromFileLoaded)\n    //console.log(getAttachment())'\n    generateAttachment(file,id);\n  };\n\n  fileReader.readAsDataURL(file);   //READ IN BASE64   //fileReader.readAsText(file, \"UTF-8\");\n}\n\nfunction attachmentIconType(name){\n  let attachmentIcon=\"\"\n  if(name===\"txt\"){\n    attachmentIcon=\"./assets/DOC.svg\";\n  }\n  else if(name===\"docx\" || name===\"doc\" || name===\"odt\" || name===\"rtf\"){\n    attachmentIcon=\"./assets/DOC.svg\";\n  }\n  else if(name===\"pdf\"){\n    attachmentIcon=\"./assets/PDF.svg\";\n  }\n  else if(name===\"ppt\" || name===\"pptx\" || name===\"odp\"){\n    attachmentIcon=\"./assets/PPT.svg\";\n  }\n  else if(name===\"xls\" || name===\"xlxs\" || name===\"ods\"){\n    attachmentIcon=\"./assets/XL.svg\";\n  } \n  else if(name===\"jpg\" || name===\"ico\" || name===\"gif\" || name===\"png\" || name===\"svg\" || name===\"tiff\"){\n    attachmentIcon=\"./assets/IMG.svg\";\n  }\n  else if(name===\"mp4\" || name===\"mov\" || name===\"avi\" || name===\"webm\" || name===\"webp\" || name===\"wmv\"){\n    attachmentIcon=\"./assets/VID.svg\";\n  }\n  else if(name===\"ogg\" || name===\"wap\" || name===\"mp3\" || name===\"mp3\" || name===\"mp3\"){\n    attachmentIcon=\"./assets/Music.svg\";\n  }\n  // else if(name===\"ppt\"){\n  //   attachmentIcon=\"./assets/PPT.svg\";\n  // }\n  // else if(name===\"ppt\"){\n  //   attachmentIcon=\"./assets/PPT.svg\";\n  // }\n  else{\n    attachmentIcon=\"./assets/DEFAULT.svg\"\n  }\n  return attachmentIcon;\n}\n\n//GENRATE ATTACHMENT\nfunction generateAttachment (file,id){\nlet mailAttachmentItemDiv = document.createElement('div')\nlet wrapper = document.getElementsByClassName('mail-attachment-wrapper')[0]\nwrapper.style.marginTop=\"2vh\"\n\nmailAttachmentItemDiv.className = 'mail-attachment-item'\nmailAttachmentItemDiv.setAttribute('id',id)\nlet mailAttachmentItemIcon = document.createElement('div')\nmailAttachmentItemIcon.className = 'mail-attachment-item-icon'\nlet attsvgname=(file.name).substring((file.name).lastIndexOf('.') + 1)\nlet AttachmentSVG=`<img style=\"width:30px;height:30px\" src=`+attachmentIconType(\"\"+attsvgname)+`>`\nmailAttachmentItemIcon.innerHTML=(AttachmentSVG)\n\nlet mailAttachmentItemDetail = document.createElement('div')\nmailAttachmentItemDetail.className = 'mail-attachment-item-detail'\nmailAttachmentItemDetail.title = `${file.name}`\nlet mailAttachmentItemDetailName = document.createElement('div')\nmailAttachmentItemDetailName.className = 'mail-attachment-item-detail-name'\nlet attachmentName = document.createElement('p')\nattachmentName.textContent = `${file.name}`\nlet mailAttachmentItemDetailSize = document.createElement('div')\nmailAttachmentItemDetailSize.className = 'mail-attachment-item-detail-size'\nmailAttachmentItemDetailSize.innerHTML = `${file.size} KB`\n\nmailAttachmentItemDetailName.appendChild(attachmentName)\nmailAttachmentItemDetail.appendChild(mailAttachmentItemDetailName)\nmailAttachmentItemDetail.appendChild(mailAttachmentItemDetailSize)\nmailAttachmentItemDetail.onclick = ()=>downloadAttachment(file)\n\n\nlet mailAttachmentItemClose =document.createElement('div')\nmailAttachmentItemClose.className = \"mail-attachment-item-close\"\nmailAttachmentItemClose.innerHTML=`\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"75%\" fill=\"#005A9E\" class=\"attachment-close\" viewBox=\"0 0 16 16\">\n<path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"></path>\n</svg>\n`\nmailAttachmentItemClose.onclick = (e)=> closeAttachment(e)\n\n// let svgNSClose = 'http://www.w3.org/2000/svg';\n// let svgElClose = document.createElementNS(svgNSClose, 'svg');\n// let pathElClose = document.createElementNS(svgNSClose, 'path');\n// svgElClose.setAttribute('class', 'bi bi-x');\n// svgElClose.setAttribute('width', '75%');\n// pathElClose.setAttribute('d', 'M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z');\n// svgElClose.setAttribute('fill', 'grey');\n// svgElClose.setAttribute('viewBox', '0 0 16 16');\n\n// svgElClose.appendChild(pathElClose)\n// mailAttachmentItemClose.appendChild(svgElClose)\n// mailAttachmentItemDiv.appendChild()\nmailAttachmentItemDiv.appendChild(mailAttachmentItemIcon)\nmailAttachmentItemDiv.appendChild(mailAttachmentItemDetail)\nmailAttachmentItemDiv.appendChild(mailAttachmentItemClose)\n\nwrapper.appendChild(mailAttachmentItemDiv)\n}\n\n//CLOSE BUTTON ON ATTACHMENT\nfunction closeAttachment(e){\n  console.log(e)\n//removeAttachment(e.target.parentElement.parentElement.ID)\ntry{\nconsole.log(\"Some error in removal of attachmnet in factory function \")\nlet wrapper = document.getElementsByClassName('mail-attachment-wrapper')[0]\n// console.log(wrapper)\nconsole.log(e.target.parentElement.parentElement.parentElement)\nremoveAttachment(e.target.parentElement.id)\n// wrapper.remove(e.target.parentElement.parentElement.parentElement)\ndocument.querySelector(\".mail-attachment-wrapper\").removeChild(e.target.parentElement)\nconsole.log(getAttachment())\n}\ncatch(e){\nconsole.log(\"Try To close attachment again\")\n}\n}\n//DOWNLOAD ATTACHMENT\nfunction downloadAttachment(file){\n  \nlet filename = file.name;   \n}\n var Emailid;\n//  alert(`Email Id ${Emailid}`)\n// Contacts (To,CC,Bcc) DropDown\nfunction onMessageFromParent(data) {\n  \n  //console.log(JSON.parse(data.message)); \n\n  if(JSON.parse(data.message).type === \"Email\"){\n   Emailid = JSON.parse(data.message).Email\n      // alert(Emailid)\n   console.log(Emailid);\n  let frombox= document.querySelector(\".from-id\")\n  frombox.innerHTML=`<div>${Emailid}</div>`\n }\n   var accessToken;\n   if(JSON.parse(data.message).type==\"accessToken\"){\n    accessToken = JSON.parse(data.message).accessToken\n    getContactItem(accessToken)\n }\n   if(JSON.parse(data.message).type==\"reply-buttons\"){\n\n    subtype=JSON.parse(data.message).subtype //GLOBAL VAR FOR SUBTYPE\n \n  let sub_type=JSON.parse(data.message).subtype\n\n  let reply_html=document.createElement('div')\n  reply_html.setAttribute('id',\"reply-html\")\n  reply_html.innerHTML=(JSON.parse(data.message).msg)\n  document.getElementById('get-subject').readOnly=true\n\n  let Fromrec=reply_html.childNodes[3].childNodes[3].childNodes[1].childNodes[3].innerText\n  //console.log(Fromrec);\n\n  let Torec=reply_html.childNodes[5].childNodes[1]\n  Torec=(Torec.childNodes[1].childNodes[0].textContent); //TO CONTENT IN IT\n  let Ccrec=(reply_html.childNodes[5].childNodes[3].childNodes[1].innerText)\n\n//SETTING TO AND CC SO KEY.OM CAN BE BUILT FOR IT \nlet to_section=\"\",cc_section=\"\";\nif(sub_type==\"reply\"){\n  document.getElementById('get-subject').value=\"Re: \"+reply_html.childNodes[1].textContent\n  \n\n  setAddress('TO',Fromrec)\n  to_section+=`<div class=\"mail-users-selected\">\n  <div class=\"mail-users-selected-avatar\">${Fromrec.trim().charAt(0)}</div>\n  <div class=\"mail-users-selected-email\">${Fromrec.trim()}</div> \n  </div>`\n \n}\nif(sub_type==\"reply-all\"){\n  document.getElementById('get-subject').value=\"Re: \"+reply_html.childNodes[1].textContent\n \n  if(!Torec.includes(Fromrec))\n  Torec=Torec+\",\"+Fromrec\n\n    if(Torec!==\"\"){\n    Torec.split(',').forEach((ele)=>{\n     \n      setAddress('TO',ele.trim())\n      to_section+=`<div class=\"mail-users-selected\">\n      <div class=\"mail-users-selected-avatar\">${ele.trim().charAt(0)}</div>\n      <div class=\"mail-users-selected-email\">${ele.trim()}</div> \n      </div>`\n      \n    })}\n    console.log(Ccrec);\n    if(Ccrec==\" Loading....\")\n    Ccrec=\"\"\n    if(Ccrec!==\"\"){\n    Ccrec.split(',').forEach((ele)=>{\n      setAddress('CC',ele.trim())\n      cc_section+=`<div class=\"mail-users-selected\">\n      <div class=\"mail-users-selected-avatar\">${ele.trim().charAt(0)}</div>\n      <div class=\"mail-users-selected-email\">${ele.trim()}</div> \n      </div>`\n      \n    })}\n  }\n  if(sub_type==\"forward\"){\n    document.getElementById('get-subject').value=\"Fw: \"+reply_html.childNodes[1].textContent\n    \n  }\n \n    //console.log(getAddress())\n\n\n\n\n  //REMOVING UNESSECERY HTML CONTENT FROM PREVIOUS WINDOW\n  reply_html.removeChild(reply_html.childNodes[11])\n  reply_html.childNodes[3].removeChild(reply_html.childNodes[3].childNodes[5]) \n  reply_html.removeChild(reply_html.childNodes[1])\n  reply_html.childNodes[2].removeChild(reply_html.childNodes[2].childNodes[1])\n\n \n  \n  //console.log(reply_html.childNodes);\n  \ndocument.querySelector(\".mail-users-input\").style.display = \"contents\"\n  document.querySelector(\"body > div.mail-container > div.mail-attachment.mail-attribute\").after(reply_html)\n  //ADDING STYLES TO Certain text\n  document.querySelector(\"#from-name\").innerHTML=`<b>From:</b>&#32;`+document.querySelector(\"#from-name\").innerHTML\n  document.querySelector(\"#date-time-value\").innerHTML=`<b>Sent:</b>&#32;`+document.querySelector(\"#date-time-value\").innerHTML\n  document.querySelector(\"#date-time-value\").style.color='black'\n  document.querySelector(\"#date-time-value\").style.fontSize='15px'\n  document.querySelector(\"#to-cc-bcc\").style.padding='2px'\n // document.getElementById('from-name')\n //document.querySelector(\"#mail-to-input\").style.readOnly=true;\n if(sub_type==\"reply-all\" || sub_type==\"reply\" ){\n document.querySelector(\"body > div.mail-container > div.mail-to.mail-attribute > div.mail-users > div\").innerHTML=to_section\n \n document.querySelector(\"#mail-cc-container > div.mail-users > div\").innerHTML=cc_section//getAddress().toString()\n\n document.getElementById('mail-bcc-input').parentElement.innerHTML=\"\"\n \n }\n //console.log(Emailid)\n document.querySelector(\"body > div.mail-container > div.mail-from.mail-attribute > div > div.mail-from-user > div\").textContent=Emailid\n\n\n  }\n}\nfunction delay(callback, ms) {\n  var timer = 0;\n  return function() {\n    var context = this, args = arguments;\n    clearTimeout(timer);\n    timer = setTimeout(function () {\n      callback.apply(context, args);\n    }, ms || 0);\n  };\n}\n\n\nvar contactEmail = []\nfunction getContactItem(accessToken) {\n\n  mailToInput.onkeyup=(delay(function (e) {\n    inputData(e)\n  }, 200));\n\n  mailCcInput.onkeyup=(delay(function (e) {\n    inputData(e)\n  }, 200));\n\n  mailBccInput.onkeyup=(delay(function (e) {\n    inputData(e)\n  }, 200));\n  \n  \nasync function inputData(e) {\n// console.log(e);\ncontactEmail = []\nlet inputdata = e.target.value \n\nif(inputdata !== \"\" ){\n\nlet getcontacts = \"https://outlook.office365.com/api/v2.0/me/people?$top=5&$search=\"+\"\"+inputdata+\"\";\n//AJAX Call\n\nawait fetch(getcontacts,{\n  method: 'GET',\n  headers: \n  {\n    \"authorization\": \"Bearer \"+accessToken,\n  },\n}).then(res=>res.json().then(items=>{\n  for(let j=0;j<(items.value).length;j++)\n  {\n  contactEmail.push((items.value)[j].ScoredEmailAddresses[0].Address)\n  }\n}))\n.catch((error) => {\n  console.log(error);\n})\n\n// await $.ajax({\n// url: getcontacts,\n// dataType: \"json\",\n// headers: { Authorization: \"Bearer \" + accessToken },\n// })\n// .done((items) => {\n//   for(let j=0;j<(items.value).length;j++){\n//        contactEmail.push((items.value)[j].ScoredEmailAddresses[0].Address)\n//       }\n// })\n// .fail(function (error) {\n//   console.log(error);\n// });\nlet parentelement = e.target.parentElement.parentElement\n let dropDownElement = parentelement.querySelector(\".mail-users-input-dropdown\") \n  dropDownElement.innerHTML=\"\";\nconsole.log(contactEmail)\n  if (!contactEmail.length) {\n    mailToInputDropdown.innerHTML = `<div class=\"for-no-contact\">\n    For using this address Enter : Enter Key\n    </div>\n    `  \n    if(e.key === \"Enter\"){\n      mailToInputDropdown.innerHTML = \" \"\n    let enterEmail = document.createElement(\"div\")\n    // enterEmail.classList.add = \"mail-users-selected\"\n    // enterEmail.style.display = \"flex\"\n    enterEmail.innerHTML= `<div class=\"mail-users-selected\">\n    <div class=\"mail-users-selected-avatar\">\n                                             ${inputdata.charAt(0)}\n                                        </div>\n                                        <div class=\"mail-users-selected-email\">\n                                              ${inputdata}\n                                        </div> \n                                        <div id =\"closebtn\" class=\"mail-users-selected-close\">\n                                              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"75%\" fill=\"#005A9E\" class=\"bi bi-x\" viewBox=\"0 0 16 16\">\n                                                  <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"/>\n                                              </svg>\n                                        </div>\n                                        </div>\n                                        `\n                                  var emailId = enterEmail.querySelector(\".mail-users-selected-email\").innerText\n                                  if (mailToInput.value){\n                                    setAddress(\"TO\",emailId.trim())\n                                     \n                                  }\n                                  else if (mailCcInput.value){\n                                    setAddress(\"CC\",emailId.trim())\n                                  }\n                                  else if (mailBccInput.value){\n                                    setAddress(\"BCC\",emailId.trim())\n                                      //console.log(selectedBccEmail)\n\n                                  } \n                                        mailToInput.value = null\n                                        mailCcInput.value = null\n                                        mailBccInput.value = null\n      let Closebtn = enterEmail.querySelector(\"#closebtn\")\n      Closebtn.onclick = () => CloseButton()\n      function CloseButton() {\n        console.log(\"Find a efficent way for closeBtn\")\n        let type=Closebtn.parentElement.parentElement.parentElement.parentElement.childNodes[1].innerText.toUpperCase()\n        console.log(Closebtn.parentElement.parentElement.parentElement.children[1].innerText)\n        let email=(Closebtn.parentElement.children[1].innerText)\n        removeAddress(type,email)\n        enterEmail.innerHTML = \"\"\n              \n      }\n              parentelement.prepend(enterEmail)\n\n}\n  }\n\n  contactEmail.forEach(item => {\n    var dropDownItem = document.createElement(\"div\")\n    // dropDownItem.classList.add = \"mail-users-input-dropdown-item\"\n    // dropDownItem.style.display = \"flex\"\n    dropDownItem.innerHTML = `<div class=\"mail-users-input-dropdown-item\">\n                                  <div class=\"mail-users-input-dropdown-item-avatar\">\n                                      ${item.charAt(0)}\n                                  </div>\n                                  <div class=\"mail-users-input-dropdown-item-email\">\n                                       ${item}\n                                  </div>\n                                  </div>\n                                  `;\n    dropDownElement.appendChild(dropDownItem) //error\n  \n    //selection \n    let selectUserData = document.createElement(\"div\")\n    // selectUserData.classList.add = \"mail-users-selected\"\n    // selectUserData.style.display = \"flex\"\n    dropDownItem.addEventListener(\"click\", () => {\n      selectUserData.innerHTML = ` <div class=\"mail-users-selected\">\n                                        <div class=\"mail-users-selected-avatar\">\n                                             ${item.charAt(0)}\n                                        </div>\n                                        <div class=\"mail-users-selected-email\">\n                                              ${item}\n                                        </div> \n                                        <div id =\"closebtn\" class=\"mail-users-selected-close\">\n                                              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"75%\" fill=\"#005A9E\" class=\"bi bi-x\" viewBox=\"0 0 16 16\">\n                                                  <path d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z\"/>\n                                              </svg>\n                                        </div>\n                                        </div>\n                                   `\n                                   var emailId = selectUserData.querySelector(\".mail-users-selected-email\").innerText.trim()\n                                   if (mailToInput.value){\n                                     if((getAddress().to.includes(emailId)==false))\n                                     setAddress(\"TO\",emailId.trim())\n                                       console.log(getAddress())\n                                   }\n                                   else if (mailCcInput.value){\n                                     if((getAddress().cc.includes(emailId)==false))\n                                     setAddress(\"CC\",emailId.trim())\n                                       console.log(getAddress())\n                                   }\n                                   else if (mailBccInput.value){\n                                     if((getAddress().bcc.includes(emailId)==false))\n                                     setAddress(\"BCC\",emailId.trim())\n                                       console.log(getAddress())\n \n                                   } \n    \n      mailToInput.value = null\n      mailCcInput.value = null\n      mailBccInput.value = null \n      dropDownElement.innerHTML=\"\"\n\n let Closebtn = selectUserData.querySelector(\"#closebtn\")\n      Closebtn.onclick = () => CloseButton()\n      function CloseButton() {\n        console.log(\"Find a efficent way for closeBtnO\")\n        let type=Closebtn.parentElement.parentElement.parentElement.parentElement.childNodes[1].innerText.toUpperCase()\n        let email=(Closebtn.parentElement.children[1].innerText)\n        removeAddress(type,email)\n        console.log(getAddress())\n        selectUserData.innerHTML = \"\"\n              }\n           parentelement.prepend(selectUserData) \n           \n    })\n  \n    });\n    \n    }else{\n      document.querySelector(\".mail-users-input-dropdown\").innerHTML=\"\";\n      console.log(\"empty input data (Hardcoded)\");\n    }\n}\n}\n\n//# sourceURL=webpack:///./src/Compose_Window/com-window.js?");

/***/ }),

/***/ "./src/ContactFactory/contactFactory.js":
/*!**********************************************!*\
  !*** ./src/ContactFactory/contactFactory.js ***!
  \**********************************************/
/*! exports provided: default */
/*! exports used: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Contactfactory; });\nfunction Contactfactory(){\n  var contactArray = [];\n  var contactName = [];\n  var accessToken;\n  var nextlink=\"\";\n  var hasMore = true;\n  var url  = \"https://outlook.office365.com/api/v2.0/me/contacts\";\n\n  \n  //intersection observer \n  let options = {\n   root: null ,\n   rootMargin: '0px',\n   threshold: 1\n }     \n let observerI;\n  return[\n\nfunction setAccessToken(acc)\n{\n      accessToken = acc;\n     //console.log(accessToken)\n},\n\nfunction getAccessToken(){      \n   return accessToken; \n   \n},\n async function syncContact(){\n   console.log(\"sync Contact\")\n   document.querySelector('#sync').style.pointerEvents = 'none';\n   var LoadingDiv;\n   let contact_Container=document.querySelector(\"#main_Container > div > div.contact_Container\")\n   contact_Container.innerHTML = \"\"\n   fetch(url,{\n      method: 'GET',\n      headers: \n      {\n        \"authorization\": \"Bearer \"+accessToken,\n      },\n    }).then(res=>res.json().then(items=>{\n//  await $.ajax({\n//  url: url,\n//  dataType: \"json\",\n//  headers: { Authorization: \"Bearer\" + accessToken },\n//     }).done((items) => {\n            if(nextlink){\n            hasMore=true;\n            }\n  let data = JSON.stringify(items.value);\n  LoadingDiv = document.createElement(\"div\")\n  LoadingDiv.setAttribute(\"id\",\"loading\")\n  LoadingDiv.innerText = \"Loading....\"\n  contact_Container.appendChild(LoadingDiv)\n\n  async function getnextLink(){\n   console.log(\"call getNextLink\")\n   if( hasMore === true ){\n     contactArray=[]\n     contactName=[]\n     fetch(url,{\n      method: 'GET',\n      headers: \n      {\n        \"authorization\": \"Bearer \"+accessToken,\n      },\n\n     }).then(res=>res.json())\n//     $.ajax({\n//     url: url,\n//     dataType: \"json\",\n//     headers: { Authorization: \"Bearer \" + accessToken },\n//  })\n .then((items) => {\n    url = items['@odata.nextLink']\n    if(url === undefined ){\n      hasMore = false\n     }\n    let data = JSON.stringify(items.value);\n   //  console.log(items)\n    for(let j=0;j<(items.value).length;j++){\n    contactArray.push((items.value)[j].EmailAddresses[0].Address)\n    contactName.push((items.value)[j].DisplayName)\n   //  console.log(contactName[j],contactArray[j])\n   }\n\n   if(contactArray.length === 0 ){\n    LoadingDiv.innerHTML = \" \"\n    let noContact = document.createElement('div');\n    noContact.classList.add('contact_div');\n    noContact.innerHTML =`<div class=\"no-contact\">\n                      No Contacts\n                  </div>\n    `\n    contact_Container.appendChild(noContact);\n   }else{\n   for (let i = 0; i <contactArray.length; i++) {\n     var newContact = document.createElement('div');\n     newContact.classList.add('contact_div');\n     newContact.innerHTML = `<div class=\"item-avatar\">\n                                <span>${contactName[i].split(\" \").map((n)=>n[0]).join(\"\").toUpperCase()}</span> \n                              </div>\n                              <div class=\"item-name-email\">\n                                 <div class=\"contact_name\">\n                                       ${contactName[i]}\n                                 </div>\n                                <div  class=\"contact_email\">\n                                   ${contactArray[i]}   \n                                </div>\n                              </div>\n                              <div class=\"invite_btn\">\n                                 <span>Invite</span>\n                              </div>`;\n                         LoadingDiv.before(newContact);\n     }    \n    }\n     console.log(hasMore)\n   })\n  }\n   else if(hasMore === false) {\n       console.log(\"disconnect\")\n       observerI.disconnect();\n       LoadingDiv.style.display = \"none\"\n   }\n}\n\nobserverI = new IntersectionObserver(getnextLink, options);\n   let target = document.getElementById(\"loading\")\n   //observer target\n   observerI.observe(target);\n    \n}))\n.catch((error)=> {\n   console.log(error);\n });\n\n\n },\n]\n}\n\n\n\n//# sourceURL=webpack:///./src/ContactFactory/contactFactory.js?");

/***/ }),

/***/ "./src/FACTORY/factory.js":
/*!********************************!*\
  !*** ./src/FACTORY/factory.js ***!
  \********************************/
/*! exports provided: default */
/*! exports used: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Factory; });\nfunction Factory(){\n    let subject=\"\"\n    let body=\"\";\n    let attachment=[]//{attachmentID:[],attachmnetMime:[],attachmentName:[],attachmentContent:[]}\n    let Address={to:[],cc:[],bcc:[]} //To,CC,BCC\n    let contactArray = []\n    let contactnextLink=\"\";\n    let Message={\n        subject,\n        body,\n        attachment,\n        Address\n    }\n\n    return [\n    //------------------------------------------START-----------------------------------------------------------\n\n    //-----------------------------------------GETTERS----------------------------------------------------------\n    function getSubject(){\n        return subject;\n    },\n    function getBody(){\n        return body;\n    },\n    function getAttachment(){\n        return attachment;\n    },\n    function getAddress(){\n        return Address;\n    },\n    function getMessage(){\n        return Message;\n    },\n    function getContactArray(){\n        return contactArray;\n    },\n    // function getContactLink(){\n    //     return contactArray;\n    // },\n\n     //---------------------------------------SETTERS-----------------------------------------------------------\n    function setSubject(Subject){\n    subject=Subject\n    },\n    function setBody(Body){\n    body=Body\n    },\n    function setAttachment(ID,MIME,NAME,CONTENT){\n        \n    attachment.push({\n        id:ID,\n        mimeType:MIME,\n        filename:NAME,\n        content:CONTENT\n    }) \n    console.log(attachment);\n    },\n    function setAddress(type,email){\n    if(type==\"TO\"){\n        Address.to.push(email)\n    }\n    if(type==\"CC\"){\n        Address.cc.push(email)\n    }\n    if(type==\"BCC\"){\n        Address.bcc.push(email)\n    }\n    },\n    function setContactArray(contact){\n         contactArray.push(contact)\n    },\n    // function setContactLink(contact){\n    //     contactnextLink=contact;\n    // },\n    //............................................REMOVER----------------------------------------------------------\n    function removeAttachment(ID){\n        let index=0;        \n        // index=(attachment.id+\"\").indexOf(ID)\n        for(let i=0;i<attachment.length;i++){\n            if(attachment[i].id==ID){\n                index=i;\n            }\n        }\n        //console.log(attachment.id,ID)\n\n        console.log(index) //-1\n        \n        attachment.splice(index,1)\n        console.log(attachment);\n    },\n    function removeAddress(type,email){\n        //console.log(type,email)\n       let index;\n        if(type==\"TO\"){\n            index=Address.to.indexOf(email)\n            //console.log(Address.to,email,index)\n            Address.to.splice(index,1)\n        }\n        if(type==\"CC\"){\n            index=Address.cc.indexOf(email)\n            Address.cc.splice(index,1)\n        }\n        if(type==\"BCC\"){\n            index=Address.bcc.indexOf(email)\n            Address.bcc.splice(index,1)\n        }  \n    }\n\n    \n    //--------------------------------------------END----------------------------------------------------------\n    ]\n    }\n\n//# sourceURL=webpack:///./src/FACTORY/factory.js?");

/***/ })

/******/ });